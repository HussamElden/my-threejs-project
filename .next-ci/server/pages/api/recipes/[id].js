"use strict";(()=>{var e={};e.id=198,e.ids=[198],e.modules={1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1524:(e,r,t)=>{t.r(r),t.d(r,{config:()=>u,default:()=>p,routeModule:()=>c});var i={};t.r(i),t.d(i,{default:()=>o});var n=t(3480),s=t(8667),a=t(6435),d=t(9302);async function o(e,r){let{id:t}=e.query;try{if("GET"===e.method){let e=await d.A.recipe.findUnique({where:{id:parseInt(t)},include:{product:!0,ingredients:{include:{ingredient:!0}}}});if(!e)return r.status(404).json({error:"Recipe not found"});r.status(200).json(e)}else if("PUT"===e.method){let{variant:i,ingredients:n}=e.body;if(!i||!n||!Array.isArray(n))return r.status(400).json({error:"Variant and ingredients array are required"});let s=n.map(e=>e.ingredientId);if((await d.A.ingredient.findMany({where:{id:{in:s}}})).length!==s.length)return r.status(400).json({error:"Some ingredients do not exist"});let a=await d.A.$transaction(async e=>(await e.recipe.update({where:{id:parseInt(t)},data:{variant:i}}),await e.recipeIngredient.deleteMany({where:{recipeId:parseInt(t)}}),await Promise.all(n.map(r=>e.recipeIngredient.create({data:{recipeId:parseInt(t),ingredientId:r.ingredientId,quantity:parseFloat(r.quantity)}}))),await e.recipe.findUnique({where:{id:parseInt(t)},include:{product:!0,ingredients:{include:{ingredient:!0}}}})));r.status(200).json(a)}else"DELETE"===e.method?(await d.A.$transaction(async e=>{await e.recipeIngredient.deleteMany({where:{recipeId:parseInt(t)}}),await e.recipe.delete({where:{id:parseInt(t)}})}),r.status(200).json({message:"Recipe deleted successfully"})):(r.setHeader("Allow",["GET","PUT","DELETE"]),r.status(405).json({error:`Method ${e.method} not allowed`}))}catch(e){console.error("Recipe API error:",e),r.status(500).json({error:"Internal server error"})}}let p=(0,a.M)(i,"default"),u=(0,a.M)(i,"config"),c=new n.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/recipes/[id]",pathname:"/api/recipes/[id]",bundlePath:"",filename:""},userland:i})},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3873:e=>{e.exports=require("path")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8474:e=>{e.exports=require("node:events")},9021:e=>{e.exports=require("fs")}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[285],()=>t(1524));module.exports=i})();