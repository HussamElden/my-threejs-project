"use strict";(()=>{var e={};e.id=804,e.ids=[804],e.modules={1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3873:e=>{e.exports=require("path")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8474:e=>{e.exports=require("node:events")},9e3:(e,r,t)=>{t.r(r),t.d(r,{config:()=>p,default:()=>u,routeModule:()=>c});var i={};t.r(i),t.d(i,{default:()=>d});var n=t(3480),o=t(8667),s=t(6435),a=t(9302);async function d(e,r){try{if("GET"===e.method){let e=await a.A.recipe.findMany({include:{product:!0,ingredients:{include:{ingredient:!0}}},orderBy:[{product:{name:"asc"}},{variant:"asc"}]});r.status(200).json(e)}else if("POST"===e.method){let{productId:t,variant:i,ingredients:n}=e.body;if(!t||!i||!n||!Array.isArray(n))return r.status(400).json({error:"ProductId, variant, and ingredients array are required"});let o=n.map(e=>e.ingredientId);if((await a.A.ingredient.findMany({where:{id:{in:o}}})).length!==o.length)return r.status(400).json({error:"Some ingredients do not exist"});let s=await a.A.$transaction(async e=>{let r=await e.recipe.create({data:{productId:parseInt(t),variant:i}});return await Promise.all(n.map(t=>e.recipeIngredient.create({data:{recipeId:r.id,ingredientId:t.ingredientId,quantity:parseFloat(t.quantity)}}))),await e.recipe.findUnique({where:{id:r.id},include:{product:!0,ingredients:{include:{ingredient:!0}}}})});r.status(201).json(s)}else r.setHeader("Allow",["GET","POST"]),r.status(405).json({error:`Method ${e.method} not allowed`})}catch(e){console.error("Recipes API error:",e),r.status(500).json({error:"Internal server error"})}}let u=(0,s.M)(i,"default"),p=(0,s.M)(i,"config"),c=new n.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/recipes",pathname:"/api/recipes",bundlePath:"",filename:""},userland:i})},9021:e=>{e.exports=require("fs")}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[285],()=>t(9e3));module.exports=i})();